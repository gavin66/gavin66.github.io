<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">



  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">



























  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/uploads/favicon.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.6.0',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Systemctl是一个systemd工具，主要负责控制systemd系统和服务管理器。 Systemd是一个系统管理守护进程、工具和库的集合，用于取代System V初始进程。Systemd的功能是用于集中管理和配置类UNIX系统。 在Linux生态系统中，Systemd被部署到了大多数的标准Linux发行版中，只有为数不多的几个发行版尚未部署。Systemd通常是所有其它守护进程的父进程，但并">
<meta name="keywords" content="命令,Linux,systemctl">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 命令 - systemctl">
<meta property="og:url" content="http://blog.imgavin.me/2018/04/19/linux-cmd-systemctl/index.html">
<meta property="og:site_name" content="Gavin&#39;s Blog">
<meta property="og:description" content="Systemctl是一个systemd工具，主要负责控制systemd系统和服务管理器。 Systemd是一个系统管理守护进程、工具和库的集合，用于取代System V初始进程。Systemd的功能是用于集中管理和配置类UNIX系统。 在Linux生态系统中，Systemd被部署到了大多数的标准Linux发行版中，只有为数不多的几个发行版尚未部署。Systemd通常是所有其它守护进程的父进程，但并">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-05-21T06:57:13.260Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux 命令 - systemctl">
<meta name="twitter:description" content="Systemctl是一个systemd工具，主要负责控制systemd系统和服务管理器。 Systemd是一个系统管理守护进程、工具和库的集合，用于取代System V初始进程。Systemd的功能是用于集中管理和配置类UNIX系统。 在Linux生态系统中，Systemd被部署到了大多数的标准Linux发行版中，只有为数不多的几个发行版尚未部署。Systemd通常是所有其它守护进程的父进程，但并">



  <link rel="alternate" href="/atom.xml" title="Gavin's Blog" type="application/atom+xml">




  <link rel="canonical" href="http://blog.imgavin.me/2018/04/19/linux-cmd-systemctl/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Linux 命令 - systemctl | Gavin's Blog</title>
  












  <noscript>
  <style>
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion .logo-line-before i { left: initial; }
    .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Gavin's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">宁愿小众,不愿平庸</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-主页">

    
    
    

    

    <a href="/" rel="section">主页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-技术">

    
    
    

    

    <a href="/2014/08/24/page-tech/" rel="section">技术</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-生活">

    
    
    

    

    <a href="/2014/08/24/page-life/" rel="section">生活</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-归档">

    
    
    

    

    <a href="/archives/" rel="section">归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-关于">

    
    
    

    

    <a href="/about" rel="section">关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input">
</form>

<script>
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 't-bzD9AonCuAKSmSy7ZA','2.0.0');
</script>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.imgavin.me/2018/04/19/linux-cmd-systemctl/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gavin">
      <meta itemprop="description" content="宁愿小众,不愿平庸">
      <meta itemprop="image" content="/uploads/portrait.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gavin's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Linux 命令 - systemctl

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-04-19 15:00:03" itemprop="dateCreated datePublished" datetime="2018-04-19T15:00:03+08:00">2018-04-19</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/04/19/linux-cmd-systemctl/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/04/19/linux-cmd-systemctl/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2018/04/19/linux-cmd-systemctl/" class="leancloud_visitors" data-flag-title="Linux 命令 - systemctl">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Systemctl是一个systemd工具，主要负责控制systemd系统和服务管理器。</p>
<p>Systemd是一个系统管理守护进程、工具和库的集合，用于取代System V初始进程。Systemd的功能是用于集中管理和配置类UNIX系统。</p>
<p>在Linux生态系统中，Systemd被部署到了大多数的标准Linux发行版中，只有为数不多的几个发行版尚未部署。Systemd通常是所有其它守护进程的父进程，但并非总是如此。</p>
<a id="more"></a>
<h1 id="Systemd初体验和Systemctl基础"><a href="#Systemd初体验和Systemctl基础" class="headerlink" title="Systemd初体验和Systemctl基础"></a>Systemd初体验和Systemctl基础</h1><h2 id="首先检查你的系统中是否安装有systemd并确定当前安装的版本"><a href="#首先检查你的系统中是否安装有systemd并确定当前安装的版本" class="headerlink" title="首先检查你的系统中是否安装有systemd并确定当前安装的版本"></a>首先检查你的系统中是否安装有systemd并确定当前安装的版本</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl --version</span></span><br><span class="line">systemd 219</span><br><span class="line">+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ -LZ4 -SECCOMP +BLKID +ELFUTILS +KMOD +IDN</span><br></pre></td></tr></table></figure>
<p>上例中很清楚地表明，我们安装了219版本的systemd。</p>
<h2 id="检查systemd和systemctl的二进制文件和库文件的安装位置"><a href="#检查systemd和systemctl的二进制文件和库文件的安装位置" class="headerlink" title="检查systemd和systemctl的二进制文件和库文件的安装位置"></a>检查systemd和systemctl的二进制文件和库文件的安装位置</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  whereis systemd</span></span><br><span class="line">systemd: /usr/lib/systemd /etc/systemd /usr/share/systemd /usr/share/man/man1/systemd.1.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#  whereis systemctl</span></span><br><span class="line">systemctl: /usr/bin/systemctl /usr/share/man/man1/systemctl.1.gz</span><br></pre></td></tr></table></figure>
<h2 id="检查systemd是否运行"><a href="#检查systemd是否运行" class="headerlink" title="检查systemd是否运行"></a>检查systemd是否运行</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  ps -eaf | grep systemd</span></span><br><span class="line">root         1     0  0 3月18 ?       00:03:11 /usr/lib/systemd/systemd --switched-root --system --deserialize 21</span><br><span class="line">root       323     1  0 3月18 ?       00:01:45 /usr/lib/systemd/systemd-journald</span><br><span class="line">root       348     1  0 3月18 ?       00:00:00 /usr/lib/systemd/systemd-udevd</span><br><span class="line">dbus       459     1  0 3月18 ?       00:02:49 /bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation</span><br><span class="line">root       468     1  0 3月18 ?       00:01:23 /usr/lib/systemd/systemd-logind</span><br></pre></td></tr></table></figure>
<h2 id="分析systemd启动进程"><a href="#分析systemd启动进程" class="headerlink" title="分析systemd启动进程"></a>分析systemd启动进程</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemd-analyze</span></span><br><span class="line">Startup finished <span class="keyword">in</span> 690ms (kernel) + 1.288s (initrd) + 8.138s (userspace) = 10.117s</span><br></pre></td></tr></table></figure>
<h2 id="分析启动时各个进程花费的时间"><a href="#分析启动时各个进程花费的时间" class="headerlink" title="分析启动时各个进程花费的时间"></a>分析启动时各个进程花费的时间</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemd-analyze blame</span></span><br><span class="line">          5.130s network.service</span><br><span class="line">          3.022s rabbitmq-server.service</span><br><span class="line">          2.120s postfix.service</span><br><span class="line">           320ms systemd-journal-flush.service</span><br><span class="line">           296ms tuned.service</span><br><span class="line">           293ms lvm2-monitor.service</span><br><span class="line">           226ms nginx.service</span><br><span class="line">           187ms dev-vda1.device</span><br><span class="line">           181ms rc-local.service</span><br><span class="line">          ...</span><br></pre></td></tr></table></figure>
<h2 id="分析启动时的关键链"><a href="#分析启动时的关键链" class="headerlink" title="分析启动时的关键链"></a>分析启动时的关键链</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemd-analyze critical-chain</span></span><br><span class="line">The time after the unit is active or started is printed after the <span class="string">"@"</span> character.</span><br><span class="line">The time the unit takes to start is printed after the <span class="string">"+"</span> character.</span><br><span class="line"></span><br><span class="line">multi-user.target @8.129s</span><br><span class="line">└─tuned.service @6.008s +296ms</span><br><span class="line">  └─network.target @5.999s</span><br><span class="line">    └─network.service @869ms +5.130s</span><br><span class="line">      └─basic.target @811ms</span><br><span class="line">        └─sockets.target @811ms</span><br><span class="line">          └─rpcbind.socket @811ms</span><br><span class="line">            └─sysinit.target @808ms</span><br><span class="line">              └─systemd-update-utmp.service @797ms +9ms</span><br><span class="line">                └─auditd.service @642ms +154ms</span><br><span class="line">                  └─systemd-tmpfiles-setup.service @615ms +26ms</span><br><span class="line">                    └─rhel-import-state.service @531ms +83ms</span><br><span class="line">                      └─<span class="built_in">local</span>-fs.target @471ms</span><br><span class="line">                        └─<span class="built_in">local</span>-fs-pre.target @471ms</span><br><span class="line">                          └─lvm2-monitor.service @177ms +293ms</span><br><span class="line">                            └─lvm2-lvmetad.service @232ms</span><br><span class="line">                              └─lvm2-lvmetad.socket @163ms</span><br><span class="line">                                └─-.slice</span><br></pre></td></tr></table></figure>
<p><strong>重要</strong>：Systemctl接受服务（.service），挂载点（.mount），套接口（.socket）和设备（.device）作为单元。</p>
<h2 id="列出所有可用单元"><a href="#列出所有可用单元" class="headerlink" title="列出所有可用单元"></a>列出所有可用单元</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl list-unit-files</span></span><br><span class="line">UNIT FILE                                     STATE</span><br><span class="line">proc-sys-fs-binfmt_misc.automount             static</span><br><span class="line">dev-hugepages.mount                           static</span><br><span class="line">dev-mqueue.mount                              static</span><br><span class="line">proc-sys-fs-binfmt_misc.mount                 static</span><br><span class="line">sys-fs-fuse-connections.mount                 static</span><br><span class="line">sys-kernel-config.mount                       static</span><br><span class="line">sys-kernel-debug.mount                        static</span><br><span class="line">tmp.mount                                     disabled</span><br><span class="line">brandbot.path                                 disabled</span><br></pre></td></tr></table></figure>
<h2 id="列出所有运行中单元"><a href="#列出所有运行中单元" class="headerlink" title="列出所有运行中单元"></a>列出所有运行中单元</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl list-units</span></span><br><span class="line">  UNIT                                                              LOAD   ACTIVE SUB       DESCRIPTION</span><br><span class="line">  proc-sys-fs-binfmt_misc.automount                                 loaded active waiting   Arbitrary Executable File Formats File System Automount Point</span><br><span class="line">  sys-devices-pci0000:00-0000:00:03.0-virtio0-net-eth0.device       loaded active plugged   Virtio network device</span><br><span class="line">  sys-devices-pci0000:00-0000:00:04.0-virtio1-block-vda-vda1.device loaded active plugged   /sys/devices/pci0000:00/0000:00:04.0/virtio1/block/vda/vda1</span><br><span class="line">  sys-devices-pci0000:00-0000:00:04.0-virtio1-block-vda.device      loaded active plugged   /sys/devices/pci0000:00/0000:00:04.0/virtio1/block/vda</span><br><span class="line">  sys-devices-platform-serial8250-tty-ttyS1.device                  loaded active plugged   /sys/devices/platform/serial8250/tty/ttyS1</span><br></pre></td></tr></table></figure>
<h2 id="列出所有失败单元"><a href="#列出所有失败单元" class="headerlink" title="列出所有失败单元"></a>列出所有失败单元</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl --failed</span></span><br><span class="line">  UNIT              LOAD   ACTIVE SUB    DESCRIPTION</span><br><span class="line">● kdump.service     loaded failed failed Crash recovery kernel arming</span><br><span class="line">● postfix.service   loaded failed failed Postfix Mail Transport Agent</span><br><span class="line">● YDService.service loaded failed failed LSB: tomcat service</span><br><span class="line"></span><br><span class="line">LOAD   = Reflects whether the unit definition was properly loaded.</span><br><span class="line">ACTIVE = The high-level unit activation state, i.e. generalization of SUB.</span><br><span class="line">SUB    = The low-level unit activation state, values depend on unit <span class="built_in">type</span>.</span><br><span class="line"></span><br><span class="line">3 loaded units listed. Pass --all to see loaded but inactive units, too.</span><br><span class="line">To show all installed unit files use <span class="string">'systemctl list-unit-files'</span>.</span><br></pre></td></tr></table></figure>
<h2 id="检查某个单元（如-cron-service）是否启用"><a href="#检查某个单元（如-cron-service）是否启用" class="headerlink" title="检查某个单元（如 cron.service）是否启用"></a>检查某个单元（如 cron.service）是否启用</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl is-enabled crond.service</span></span><br><span class="line">enabled</span><br></pre></td></tr></table></figure>
<h2 id="检查某个单元或服务是否运行"><a href="#检查某个单元或服务是否运行" class="headerlink" title="检查某个单元或服务是否运行"></a>检查某个单元或服务是否运行</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl status firewalld.service</span></span><br><span class="line">● firewalld.service - firewalld - dynamic firewall daemon</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; disabled; vendor preset: enabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line">     Docs: man:firewalld(1)</span><br></pre></td></tr></table></figure>
<h1 id="使用Systemctl控制并管理服务"><a href="#使用Systemctl控制并管理服务" class="headerlink" title="使用Systemctl控制并管理服务"></a>使用Systemctl控制并管理服务</h1><h2 id="列出所有服务（包括启用的和禁用的）"><a href="#列出所有服务（包括启用的和禁用的）" class="headerlink" title="列出所有服务（包括启用的和禁用的）"></a>列出所有服务（包括启用的和禁用的）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl list-unit-files --type=service</span></span><br><span class="line">UNIT FILE                                     STATE</span><br><span class="line">acpid.service                                 enabled</span><br><span class="line">arp-ethers.service                            disabled</span><br><span class="line">atd.service                                   enabled</span><br><span class="line">auditd.service                                enabled</span><br><span class="line">autovt@.service                               enabled</span><br><span class="line">blk-availability.service                      disabled</span><br><span class="line">brandbot.service                              static</span><br><span class="line">chrony-dnssrv@.service                        static</span><br><span class="line">chrony-wait.service                           disabled</span><br></pre></td></tr></table></figure>
<h2 id="Linux中如何启动、重启、停止、重载服务以及检查服务（如-httpd-service）状态"><a href="#Linux中如何启动、重启、停止、重载服务以及检查服务（如-httpd-service）状态" class="headerlink" title="Linux中如何启动、重启、停止、重载服务以及检查服务（如 httpd.service）状态"></a>Linux中如何启动、重启、停止、重载服务以及检查服务（如 httpd.service）状态</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl start httpd.service</span></span><br><span class="line"><span class="comment"># systemctl restart httpd.service</span></span><br><span class="line"><span class="comment"># systemctl stop httpd.service</span></span><br><span class="line"><span class="comment"># systemctl reload httpd.service</span></span><br><span class="line"><span class="comment"># systemctl status httpd.service</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：当我们使用systemctl的start，restart，stop和reload命令时，我们不会从终端获取到任何输出内容，只有status命令可以打印输出。</p>
<h2 id="如何激活服务并在启动时启用或禁用服务（即系统启动时自动启动服务）"><a href="#如何激活服务并在启动时启用或禁用服务（即系统启动时自动启动服务）" class="headerlink" title="如何激活服务并在启动时启用或禁用服务（即系统启动时自动启动服务）"></a>如何激活服务并在启动时启用或禁用服务（即系统启动时自动启动服务）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl is-active httpd.service</span></span><br><span class="line"><span class="comment"># systemctl enable httpd.service</span></span><br><span class="line"><span class="comment"># systemctl disable httpd.service</span></span><br></pre></td></tr></table></figure>
<h2 id="如何屏蔽（让它不能启动）或显示服务（如-httpd-service）"><a href="#如何屏蔽（让它不能启动）或显示服务（如-httpd-service）" class="headerlink" title="如何屏蔽（让它不能启动）或显示服务（如 httpd.service）"></a>如何屏蔽（让它不能启动）或显示服务（如 httpd.service）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl mask httpd.service</span></span><br><span class="line">ln -s <span class="string">'/dev/null'</span> <span class="string">'/etc/systemd/system/httpd.service'</span></span><br><span class="line"><span class="comment"># systemctl unmask httpd.service</span></span><br><span class="line">rm <span class="string">'/etc/systemd/system/httpd.service'</span></span><br></pre></td></tr></table></figure>
<h2 id="使用systemctl命令杀死服务"><a href="#使用systemctl命令杀死服务" class="headerlink" title="使用systemctl命令杀死服务"></a>使用systemctl命令杀死服务</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl kill httpd</span></span><br><span class="line"><span class="comment"># systemctl status httpd</span></span><br></pre></td></tr></table></figure>
<h1 id="使用Systemctl控制并管理挂载点"><a href="#使用Systemctl控制并管理挂载点" class="headerlink" title="使用Systemctl控制并管理挂载点"></a>使用Systemctl控制并管理挂载点</h1><h2 id="列出所有系统挂载点"><a href="#列出所有系统挂载点" class="headerlink" title="列出所有系统挂载点"></a>列出所有系统挂载点</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl list-unit-files --type=mount</span></span><br><span class="line">UNIT FILE                     STATE</span><br><span class="line">dev-hugepages.mount           static</span><br><span class="line">dev-mqueue.mount              static</span><br><span class="line">proc-sys-fs-binfmt_misc.mount static</span><br><span class="line">sys-fs-fuse-connections.mount static</span><br><span class="line">sys-kernel-config.mount       static</span><br><span class="line">sys-kernel-debug.mount        static</span><br><span class="line">tmp.mount                     disabled</span><br></pre></td></tr></table></figure>
<h2 id="挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态"><a href="#挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态" class="headerlink" title="挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态"></a>挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl start tmp.mount</span></span><br><span class="line"><span class="comment"># systemctl stop tmp.mount</span></span><br><span class="line"><span class="comment"># systemctl restart tmp.mount</span></span><br><span class="line"><span class="comment"># systemctl reload tmp.mount</span></span><br><span class="line"><span class="comment"># systemctl status tmp.mount</span></span><br></pre></td></tr></table></figure>
<h2 id="在启动时激活、启用或禁用挂载点（系统启动时自动挂载）"><a href="#在启动时激活、启用或禁用挂载点（系统启动时自动挂载）" class="headerlink" title="在启动时激活、启用或禁用挂载点（系统启动时自动挂载）"></a>在启动时激活、启用或禁用挂载点（系统启动时自动挂载）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl is-active tmp.mount</span></span><br><span class="line"><span class="comment"># systemctl enable tmp.mount</span></span><br><span class="line"><span class="comment"># systemctl disable  tmp.mount</span></span><br></pre></td></tr></table></figure>
<h2 id="在Linux中屏蔽（让它不能启用）或可见挂载点"><a href="#在Linux中屏蔽（让它不能启用）或可见挂载点" class="headerlink" title="在Linux中屏蔽（让它不能启用）或可见挂载点"></a>在Linux中屏蔽（让它不能启用）或可见挂载点</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl mask tmp.mount</span></span><br><span class="line">ln -s <span class="string">'/dev/null'</span> <span class="string">'/etc/systemd/system/tmp.mount'</span></span><br><span class="line"><span class="comment"># systemctl unmask tmp.mount</span></span><br><span class="line">rm <span class="string">'/etc/systemd/system/tmp.mount'</span></span><br></pre></td></tr></table></figure>
<h1 id="使用Systemctl控制并管理套接口"><a href="#使用Systemctl控制并管理套接口" class="headerlink" title="使用Systemctl控制并管理套接口"></a>使用Systemctl控制并管理套接口</h1><h2 id="列出所有可用系统套接口"><a href="#列出所有可用系统套接口" class="headerlink" title="列出所有可用系统套接口"></a>列出所有可用系统套接口</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl list-unit-files --type=socket</span></span><br><span class="line">UNIT FILE                    STATE</span><br><span class="line">dbus.socket                  static</span><br><span class="line">dm-event.socket              enabled</span><br><span class="line">epmd.socket                  disabled</span><br><span class="line">epmd@.socket                 disabled</span><br><span class="line">lvm2-lvmetad.socket          enabled</span><br><span class="line">lvm2-lvmpolld.socket         enabled</span><br><span class="line">rpcbind.socket               enabled</span><br><span class="line">rsyncd.socket                disabled</span><br><span class="line">sshd.socket                  disabled</span><br><span class="line">syslog.socket                static</span><br><span class="line">systemd-initctl.socket       static</span><br><span class="line">systemd-journald.socket      static</span><br><span class="line">systemd-shutdownd.socket     static</span><br><span class="line">systemd-udevd-control.socket static</span><br><span class="line">systemd-udevd-kernel.socket  static</span><br></pre></td></tr></table></figure>
<h2 id="在Linux中启动、重启、停止、重载套接口并检查其状态"><a href="#在Linux中启动、重启、停止、重载套接口并检查其状态" class="headerlink" title="在Linux中启动、重启、停止、重载套接口并检查其状态"></a>在Linux中启动、重启、停止、重载套接口并检查其状态</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl start cups.socket</span></span><br><span class="line"><span class="comment"># systemctl restart cups.socket</span></span><br><span class="line"><span class="comment"># systemctl stop cups.socket</span></span><br><span class="line"><span class="comment"># systemctl reload cups.socket</span></span><br><span class="line"><span class="comment"># systemctl status cups.socket</span></span><br></pre></td></tr></table></figure>
<h2 id="在启动时激活套接口，并启用或禁用它（系统启动时自启动）"><a href="#在启动时激活套接口，并启用或禁用它（系统启动时自启动）" class="headerlink" title="在启动时激活套接口，并启用或禁用它（系统启动时自启动）"></a>在启动时激活套接口，并启用或禁用它（系统启动时自启动）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl is-active cups.socket</span></span><br><span class="line"><span class="comment"># systemctl enable cups.socket</span></span><br><span class="line"><span class="comment"># systemctl disable cups.socket</span></span><br></pre></td></tr></table></figure>
<h2 id="屏蔽（使它不能启动）或显示套接口"><a href="#屏蔽（使它不能启动）或显示套接口" class="headerlink" title="屏蔽（使它不能启动）或显示套接口"></a>屏蔽（使它不能启动）或显示套接口</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl mask cups.socket</span></span><br><span class="line">ln -s <span class="string">'/dev/null'</span> <span class="string">'/etc/systemd/system/cups.socket'</span></span><br><span class="line"><span class="comment"># systemctl unmask cups.socket</span></span><br><span class="line">rm <span class="string">'/etc/systemd/system/cups.socket'</span></span><br></pre></td></tr></table></figure>
<h1 id="服务的CPU利用率（分配额）"><a href="#服务的CPU利用率（分配额）" class="headerlink" title="服务的CPU利用率（分配额）"></a>服务的CPU利用率（分配额）</h1><h2 id="获取当前某个服务的CPU分配额（如httpd）"><a href="#获取当前某个服务的CPU分配额（如httpd）" class="headerlink" title="获取当前某个服务的CPU分配额（如httpd）"></a>获取当前某个服务的CPU分配额（如httpd）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl show -p CPUShares httpd.service</span></span><br><span class="line">CPUShares=1024</span><br></pre></td></tr></table></figure>
<h2 id="将某个服务（httpd-service）的CPU分配份额限制为2000-CPUShares"><a href="#将某个服务（httpd-service）的CPU分配份额限制为2000-CPUShares" class="headerlink" title="将某个服务（httpd.service）的CPU分配份额限制为2000 CPUShares/"></a>将某个服务（httpd.service）的CPU分配份额限制为2000 CPUShares/</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl set-property httpd.service CPUShares=2000</span></span><br><span class="line"><span class="comment"># systemctl show -p CPUShares httpd.service</span></span><br><span class="line">CPUShares=2000</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：当你为某个服务设置CPUShares，会自动创建一个以服务名命名的目录（如 httpd.service），里面包含了一个名为90-CPUShares.conf的文件，该文件含有CPUShare限制信息，你可以通过以下方式查看该文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># vi /etc/systemd/system/httpd.service.d/90-CPUShares.conf </span><br><span class="line">[Service]</span><br><span class="line">CPUShares=2000</span><br></pre></td></tr></table></figure>
<h2 id="检查某个服务的所有配置细节"><a href="#检查某个服务的所有配置细节" class="headerlink" title="检查某个服务的所有配置细节"></a>检查某个服务的所有配置细节</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl show nginx</span></span><br><span class="line">Type=forking</span><br><span class="line">Restart=no</span><br><span class="line">PIDFile=/run/nginx.pid</span><br><span class="line">NotifyAccess=none</span><br><span class="line">RestartUSec=100ms</span><br><span class="line">TimeoutStartUSec=1min 30s</span><br><span class="line">TimeoutStopUSec=5s</span><br><span class="line">WatchdogUSec=0</span><br><span class="line">WatchdogTimestampMonotonic=0</span><br><span class="line">StartLimitInterval=10000000</span><br></pre></td></tr></table></figure>
<h2 id="分析某个服务（nginx）的关键链"><a href="#分析某个服务（nginx）的关键链" class="headerlink" title="分析某个服务（nginx）的关键链"></a>分析某个服务（nginx）的关键链</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemd-analyze critical-chain nginx.service</span></span><br><span class="line">The time after the unit is active or started is printed after the <span class="string">"@"</span> character.</span><br><span class="line">The time the unit takes to start is printed after the <span class="string">"+"</span> character.</span><br><span class="line"></span><br><span class="line">nginx.service +226ms</span><br><span class="line">└─network.target @5.999s</span><br><span class="line">  └─network.service @869ms +5.130s</span><br><span class="line">    └─basic.target @811ms</span><br><span class="line">      └─sockets.target @811ms</span><br><span class="line">        └─rpcbind.socket @811ms</span><br><span class="line">          └─sysinit.target @808ms</span><br><span class="line">            └─systemd-update-utmp.service @797ms +9ms</span><br><span class="line">              └─auditd.service @642ms +154ms</span><br><span class="line">                └─systemd-tmpfiles-setup.service @615ms +26ms</span><br><span class="line">                  └─rhel-import-state.service @531ms +83ms</span><br><span class="line">                    └─<span class="built_in">local</span>-fs.target @471ms</span><br><span class="line">                      └─<span class="built_in">local</span>-fs-pre.target @471ms</span><br><span class="line">                        └─lvm2-monitor.service @177ms +293ms</span><br><span class="line">                          └─lvm2-lvmetad.service @232ms</span><br><span class="line">                            └─lvm2-lvmetad.socket @163ms</span><br><span class="line">                              └─-.slice</span><br></pre></td></tr></table></figure>
<h2 id="获取某个服务（nginx）的依赖性列表"><a href="#获取某个服务（nginx）的依赖性列表" class="headerlink" title="获取某个服务（nginx）的依赖性列表"></a>获取某个服务（nginx）的依赖性列表</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl list-dependencies nginx.service</span></span><br><span class="line">nginx.service</span><br><span class="line">● ├─-.mount</span><br><span class="line">● ├─system.slice</span><br><span class="line">● └─basic.target</span><br><span class="line">●   ├─rhel-autorelabel-mark.service</span><br><span class="line">●   ├─rhel-autorelabel.service</span><br><span class="line">●   ├─rhel-configure.service</span><br><span class="line">●   ├─rhel-dmesg.service</span><br><span class="line">●   ├─rhel-loadmodules.service</span><br><span class="line">●   ├─selinux-policy-migrate-local-changes@targeted.service</span><br><span class="line">●   ├─paths.target</span><br><span class="line">●   ├─slices.target</span><br><span class="line">●   │ ├─-.slice</span><br><span class="line">●   │ └─system.slice</span><br><span class="line">●   ├─sockets.target</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="按等级列出控制组"><a href="#按等级列出控制组" class="headerlink" title="按等级列出控制组"></a>按等级列出控制组</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemd-cgls</span></span><br><span class="line">├─1 /usr/lib/systemd/systemd --switched-root --system --deserialize 21</span><br><span class="line">├─user.slice</span><br><span class="line">│ └─user-0.slice</span><br><span class="line">│   ├─session-48911.scope</span><br><span class="line">│   │ ├─17567 sshd: root@pts/0</span><br><span class="line">│   │ ├─17570 -zsh</span><br><span class="line">│   │ ├─17604 sh -c <span class="function"><span class="title">main</span></span>() &#123;   <span class="comment"># Use colors, but only if connected to a terminal, and that terminal   # supports them.   if which tput &gt;/dev/null 2&gt;&amp;1; then       ncolors=$(tput colors)   fi   if [ -t 1 ] &amp;&amp; [ -n "$ncolors" ] &amp;&amp; [ "$ncolors" -ge 8 ]; then     RED="$(tput</span></span><br><span class="line">│   │ ├─17643 zsh</span><br><span class="line">│   │ ├─27128 systemd-cgls</span><br><span class="line">│   │ └─27129 systemd-cgls</span><br><span class="line">│   └─session-1.scope</span><br><span class="line">│     ├─25471 barad_agent</span><br><span class="line">│     ├─25477 barad_agent</span><br><span class="line">│     ├─25478 barad_agent</span><br><span class="line">│     └─25839 /usr/<span class="built_in">local</span>/qcloud/stargate/sgagent -d</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="按CPU、内存、输入和输出列出控制组"><a href="#按CPU、内存、输入和输出列出控制组" class="headerlink" title="按CPU、内存、输入和输出列出控制组"></a>按CPU、内存、输入和输出列出控制组</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemd-cgtop</span></span><br><span class="line">Path                                                                                                                                                                                                                                     Tasks   %CPU   Memory  Input/s Output/s</span><br><span class="line"></span><br><span class="line">/                                                                                                                                                                                                                                           78      -   827.5M        -        -</span><br><span class="line">/system.slice/acpid.service                                                                                                                                                                                                                  1      -        -        -        -</span><br><span class="line">/system.slice/atd.service                                                                                                                                                                                                                    1      -        -        -        -</span><br><span class="line">/system.slice/auditd.service                                                                                                                                                                                                                 1      -        -        -        -</span><br><span class="line">/system.slice/crond.service                                                                                                                                                                                                                  1      -        -        -        -</span><br><span class="line">/system.slice/dbus.service                                                                                                                                                                                                                   1      -        -        -        -</span><br><span class="line">/system.slice/libstoragemgmt.service                                                                                                                                                                                                         1      -        -        -        -</span><br><span class="line">/system.slice/lvm2-lvmetad.service</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="控制系统运行等级"><a href="#控制系统运行等级" class="headerlink" title="控制系统运行等级"></a>控制系统运行等级</h1><h2 id="启动系统救援模式"><a href="#启动系统救援模式" class="headerlink" title="启动系统救援模式"></a>启动系统救援模式</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl rescue</span></span><br><span class="line">PolicyKit daemon disconnected from the bus.</span><br><span class="line">We are no longer a registered authentication agent.</span><br><span class="line"></span><br><span class="line">Broadcast message from root@server_base on pts/0 (四 2018-04-19 16:31:36 CST):</span><br><span class="line"></span><br><span class="line">The system is going down to rescue mode NOW!</span><br></pre></td></tr></table></figure>
<h2 id="进入紧急模式"><a href="#进入紧急模式" class="headerlink" title="进入紧急模式"></a>进入紧急模式</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl emergency</span></span><br><span class="line">Welcome to emergency mode! After logging <span class="keyword">in</span>, <span class="built_in">type</span> <span class="string">"journalctl -xb"</span> to view</span><br><span class="line">system logs, <span class="string">"systemctl reboot"</span> to reboot, <span class="string">"systemctl default"</span> to try again</span><br><span class="line">to boot into default mode.</span><br></pre></td></tr></table></figure>
<h2 id="列出当前使用的运行等级"><a href="#列出当前使用的运行等级" class="headerlink" title="列出当前使用的运行等级"></a>列出当前使用的运行等级</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  systemctl get-default</span></span><br><span class="line">multi-user.target</span><br></pre></td></tr></table></figure>
<h2 id="启动运行等级5，即图形模式"><a href="#启动运行等级5，即图形模式" class="headerlink" title="启动运行等级5，即图形模式"></a>启动运行等级5，即图形模式</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl isolate runlevel5.target</span></span><br><span class="line">或</span><br><span class="line"><span class="comment"># systemctl isolate graphical.target</span></span><br></pre></td></tr></table></figure>
<h2 id="启动运行等级3，即多用户模式（命令行）"><a href="#启动运行等级3，即多用户模式（命令行）" class="headerlink" title="启动运行等级3，即多用户模式（命令行）"></a>启动运行等级3，即多用户模式（命令行）</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl isolate runlevel3.target</span></span><br><span class="line">或</span><br><span class="line"><span class="comment"># systemctl isolate multiuser.target</span></span><br></pre></td></tr></table></figure>
<h2 id="设置多用户模式或图形模式为默认运行等级"><a href="#设置多用户模式或图形模式为默认运行等级" class="headerlink" title="设置多用户模式或图形模式为默认运行等级"></a>设置多用户模式或图形模式为默认运行等级</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl set-default runlevel3.target</span></span><br><span class="line"><span class="comment"># systemctl set-default runlevel5.target</span></span><br></pre></td></tr></table></figure>
<h2 id="重启、停止、挂起、休眠系统或使系统进入混合睡眠"><a href="#重启、停止、挂起、休眠系统或使系统进入混合睡眠" class="headerlink" title="重启、停止、挂起、休眠系统或使系统进入混合睡眠"></a>重启、停止、挂起、休眠系统或使系统进入混合睡眠</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl reboot</span></span><br><span class="line"><span class="comment"># systemctl halt</span></span><br><span class="line"><span class="comment"># systemctl suspend</span></span><br><span class="line"><span class="comment"># systemctl hibernate</span></span><br><span class="line"><span class="comment"># systemctl hybrid-sleep</span></span><br></pre></td></tr></table></figure>
<p><strong>运行等级说明</strong></p>
<ul>
<li>Runlevel 0 : 关闭系统</li>
<li>Runlevel 1 : 救援？维护模式</li>
<li>Runlevel 3 : 多用户，无图形系统</li>
<li>Runlevel 4 : 多用户，无图形系统</li>
<li>Runlevel 5 : 多用户，图形化系统</li>
<li>Runlevel 6 : 关闭并重启机器</li>
</ul>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="https://linux.cn/article-5926-1.html" target="_blank" rel="noopener">systemctl 命令完全指南</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html" target="_blank" rel="noopener">Systemd 入门教程：命令篇</a></li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/uploads/wechatpay_cut.jpg" alt="Gavin 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/uploads/alipay_cut.jpg" alt="Gavin 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/命令/" rel="tag"># 命令</a>
          
            <a href="/tags/Linux/" rel="tag"># Linux</a>
          
            <a href="/tags/systemctl/" rel="tag"># systemctl</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div class="social_share">
            
            
               <div id="needsharebutton-postbottom">
                 <span class="btn">
                    <i class="fa fa-share-alt" aria-hidden="true"></i>
                 </span>
               </div>
            
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/02/25/cache-collapse-cross/" rel="next" title="缓存雪崩与缓存穿透">
                <i class="fa fa-chevron-left"></i> 缓存雪崩与缓存穿透
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/28/ss-install-script/" rel="prev" title="shadowsocks 一键安装脚本">
                shadowsocks 一键安装脚本 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/portrait.jpg" alt="Gavin">
            
              <p class="site-author-name" itemprop="name">Gavin</p>
              <p class="site-description motion-element" itemprop="description">宁愿小众,不愿平庸</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">80</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">121</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                  <a href="https://github.com/gavin66" title="GitHub &rarr; https://github.com/gavin66" rel="noopener" target="_blank">GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                  <a href="https://www.v2ex.com/member/ksaa0096329" title="V2EX &rarr; https://www.v2ex.com/member/ksaa0096329" rel="noopener" target="_blank">V2EX</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                  <a href="https://segmentfault.com/u/gavin66" title="SegmentFault &rarr; https://segmentfault.com/u/gavin66" rel="noopener" target="_blank">SegmentFault</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                  <a href="http://weibo.com/lanbert" title="微博 &rarr; http://weibo.com/lanbert" rel="noopener" target="_blank">微博</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                  <a href="https://www.zhihu.com/people/Gavin23" title="知乎 &rarr; https://www.zhihu.com/people/Gavin23" rel="noopener" target="_blank">知乎</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                  <a href="https://www.douban.com/people/imgavin66" title="豆瓣 &rarr; https://www.douban.com/people/imgavin66" rel="noopener" target="_blank">豆瓣</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Systemd初体验和Systemctl基础"><span class="nav-text">Systemd初体验和Systemctl基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#首先检查你的系统中是否安装有systemd并确定当前安装的版本"><span class="nav-text">首先检查你的系统中是否安装有systemd并确定当前安装的版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查systemd和systemctl的二进制文件和库文件的安装位置"><span class="nav-text">检查systemd和systemctl的二进制文件和库文件的安装位置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查systemd是否运行"><span class="nav-text">检查systemd是否运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析systemd启动进程"><span class="nav-text">分析systemd启动进程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析启动时各个进程花费的时间"><span class="nav-text">分析启动时各个进程花费的时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析启动时的关键链"><span class="nav-text">分析启动时的关键链</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有可用单元"><span class="nav-text">列出所有可用单元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有运行中单元"><span class="nav-text">列出所有运行中单元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有失败单元"><span class="nav-text">列出所有失败单元</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查某个单元（如-cron-service）是否启用"><span class="nav-text">检查某个单元（如 cron.service）是否启用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查某个单元或服务是否运行"><span class="nav-text">检查某个单元或服务是否运行</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用Systemctl控制并管理服务"><span class="nav-text">使用Systemctl控制并管理服务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有服务（包括启用的和禁用的）"><span class="nav-text">列出所有服务（包括启用的和禁用的）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux中如何启动、重启、停止、重载服务以及检查服务（如-httpd-service）状态"><span class="nav-text">Linux中如何启动、重启、停止、重载服务以及检查服务（如 httpd.service）状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何激活服务并在启动时启用或禁用服务（即系统启动时自动启动服务）"><span class="nav-text">如何激活服务并在启动时启用或禁用服务（即系统启动时自动启动服务）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何屏蔽（让它不能启动）或显示服务（如-httpd-service）"><span class="nav-text">如何屏蔽（让它不能启动）或显示服务（如 httpd.service）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用systemctl命令杀死服务"><span class="nav-text">使用systemctl命令杀死服务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用Systemctl控制并管理挂载点"><span class="nav-text">使用Systemctl控制并管理挂载点</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有系统挂载点"><span class="nav-text">列出所有系统挂载点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态"><span class="nav-text">挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在启动时激活、启用或禁用挂载点（系统启动时自动挂载）"><span class="nav-text">在启动时激活、启用或禁用挂载点（系统启动时自动挂载）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在Linux中屏蔽（让它不能启用）或可见挂载点"><span class="nav-text">在Linux中屏蔽（让它不能启用）或可见挂载点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用Systemctl控制并管理套接口"><span class="nav-text">使用Systemctl控制并管理套接口</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有可用系统套接口"><span class="nav-text">列出所有可用系统套接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在Linux中启动、重启、停止、重载套接口并检查其状态"><span class="nav-text">在Linux中启动、重启、停止、重载套接口并检查其状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在启动时激活套接口，并启用或禁用它（系统启动时自启动）"><span class="nav-text">在启动时激活套接口，并启用或禁用它（系统启动时自启动）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#屏蔽（使它不能启动）或显示套接口"><span class="nav-text">屏蔽（使它不能启动）或显示套接口</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#服务的CPU利用率（分配额）"><span class="nav-text">服务的CPU利用率（分配额）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#获取当前某个服务的CPU分配额（如httpd）"><span class="nav-text">获取当前某个服务的CPU分配额（如httpd）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将某个服务（httpd-service）的CPU分配份额限制为2000-CPUShares"><span class="nav-text">将某个服务（httpd.service）的CPU分配份额限制为2000 CPUShares/</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查某个服务的所有配置细节"><span class="nav-text">检查某个服务的所有配置细节</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析某个服务（nginx）的关键链"><span class="nav-text">分析某个服务（nginx）的关键链</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取某个服务（nginx）的依赖性列表"><span class="nav-text">获取某个服务（nginx）的依赖性列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#按等级列出控制组"><span class="nav-text">按等级列出控制组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#按CPU、内存、输入和输出列出控制组"><span class="nav-text">按CPU、内存、输入和输出列出控制组</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#控制系统运行等级"><span class="nav-text">控制系统运行等级</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#启动系统救援模式"><span class="nav-text">启动系统救援模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#进入紧急模式"><span class="nav-text">进入紧急模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列出当前使用的运行等级"><span class="nav-text">列出当前使用的运行等级</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启动运行等级5，即图形模式"><span class="nav-text">启动运行等级5，即图形模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启动运行等级3，即多用户模式（命令行）"><span class="nav-text">启动运行等级3，即多用户模式（命令行）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置多用户模式或图形模式为默认运行等级"><span class="nav-text">设置多用户模式或图形模式为默认运行等级</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重启、停止、挂起、休眠系统或使系统进入混合睡眠"><span class="nav-text">重启、停止、挂起、休眠系统或使系统进入混合睡眠</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考"><span class="nav-text">参考</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gavin</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script src="/js/src/utils.js?v=6.6.0"></script>

  <script src="/js/src/motion.js?v=6.6.0"></script>



  
  

  
  <script src="/js/src/scrollspy.js?v=6.6.0"></script>
<script src="/js/src/post-details.js?v=6.6.0"></script>



  


  <script src="/js/src/bootstrap.js?v=6.6.0"></script>



  

  
    <script id="dsq-count-scr" src="https://gavin23.disqus.com/count.js" async></script>
  

  
    <script>
      var disqus_config = function () {
        this.page.url = "http://blog.imgavin.me/2018/04/19/linux-cmd-systemctl/";
        this.page.identifier = "2018/04/19/linux-cmd-systemctl/";
        this.page.title = 'Linux 命令 - systemctl';
        };
      function loadComments () {
        var d = document, s = d.createElement('script');
        s.src = 'https://gavin23.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      }
      
        loadComments();
      
    </script>
  













  





  

  
  <script>
    
    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1}))
                .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function () {
                  console.log('Failed to create');
                });
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "AhWzg6uJERcSBdfFp24rIGco-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "AhWzg6uJERcSBdfFp24rIGco-gzGzoHsz",
                'X-LC-Key': "ygD46J8JRaC0GkifemEHlXCf",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  
  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "default";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  
  <script src="/js/src/js.cookie.js?v=6.6.0"></script>
  <script src="/js/src/scroll-cookie.js?v=6.6.0"></script>


  

  

  

  

</body>
</html>
